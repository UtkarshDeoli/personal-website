<!DOCTYPE html>
<html lang="en" dir="ltr" class="scroll-smooth" data-default-appearance="dark"
  data-auto-appearance="true"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  
  <meta http-equiv="content-language" content="en" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>读书笔记《大规模语言模型：从理论到实践》 &middot; Utkarsh Deoli</title>
  <meta name="title" content="读书笔记《大规模语言模型：从理论到实践》 &middot; Utkarsh Deoli" />
  
  <meta name="description" content="《大规模语言模型：从理论到实践》的阅读笔记，简要地记录一些知识点" />
  <meta name="keywords" content="算法原理, 阅读笔记, " />
  
  
  <link rel="canonical" href="http://localhost:1313/articels/2023-12-10/" />
  
  
  
  
  
  
  
  
  
  
  <link type="text/css" rel="stylesheet" href="/css/main.bundle.min.81c7ce66608dd0b86aa3e571076f8794993d50f0d4a5b153013edfc28642a93c4104edfdc604558908c3624b8e99386757d81f1bf8c4452c6220cf4c63970408.css"
    integrity="sha512-gcfOZmCN0Lhqo&#43;VxB2&#43;HlJk9UPDUpbFTAT7fwoZCqTxBBO39xgRViQjDYkuOmThnV9gfG/jERSxiIM9MY5cECA==" />
  
  
  <script type="text/javascript" src="/js/appearance.min.5d428d79012944375125a88085344ec5bd884b22e856048a3bace9e7c7c4ba93bbeff8218b019bb038df26621963d060ecc1f7f6c25a73aeea476386aa34937e.js"
    integrity="sha512-XUKNeQEpRDdRJaiAhTROxb2ISyLoVgSKO6zp58fEupO77/ghiwGbsDjfJmIZY9Bg7MH39sJac67qR2OGqjSTfg=="></script>
  
  
  
  
  
  <script src="/js/zoom.min.js"></script>
  
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
  
  
  
  
  
  
  
  <meta property="og:title" content="读书笔记《大规模语言模型：从理论到实践》" />
<meta property="og:description" content="《大规模语言模型：从理论到实践》的阅读笔记，简要地记录一些知识点" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/articels/2023-12-10/" /><meta property="og:image" content="http://localhost:1313/articels/2023-12-10/feature.jpg" /><meta property="article:section" content="articels" />
<meta property="article:published_time" content="2023-12-10T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-12-10T00:00:00+00:00" />

  <meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="http://localhost:1313/articels/2023-12-10/feature.jpg" /><meta name="twitter:title" content="读书笔记《大规模语言模型：从理论到实践》"/>
<meta name="twitter:description" content="《大规模语言模型：从理论到实践》的阅读笔记，简要地记录一些知识点"/>

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "文章",
    "name": "读书笔记《大规模语言模型：从理论到实践》",
    "headline": "读书笔记《大规模语言模型：从理论到实践》",
    
    "abstract": "《大规模语言模型：从理论到实践》的阅读笔记，简要地记录一些知识点",
    "inLanguage": "en",
    "url" : "http:\/\/localhost:1313\/articels\/2023-12-10\/",
    "author" : {
      "@type": "Person",
      "name": "Utkarsh Deoli"
    },
    "copyrightYear": "2023",
    "dateCreated": "2023-12-10T00:00:00\u002b00:00",
    "datePublished": "2023-12-10T00:00:00\u002b00:00",
    
    "dateModified": "2023-12-10T00:00:00\u002b00:00",
    
    "keywords": ["算法原理","阅读笔记"],
    
    "mainEntityOfPage": "true",
    "wordCount": "1086"
  }]
  </script>


  
  
  <meta name="author" content="Utkarsh Deoli" />
  
  
  
  <link href="mailto:utkarsh.deoli@gmail.com?subject=Contacting%20from%20your%20website" rel="me" />
  
  
  <link href="https://github.com/UtkarshDeoli" rel="me" />
  
  
  <link href="https://www.linkedin.com/in/utkarshdeoli" rel="me" />
  
  
  <link href="https://x.com/utkarshdeoli" rel="me" />
  
  
  <link href="https://www.youtube.com/@utkarshdeoli" rel="me" />
  
  
  <link href="https://www.leetcode.com/sagemodeutkarsh" rel="me" />
  
  
  
  

<script src="/lib/jquery/jquery.slim.min.js" integrity=""></script>











<link type="text/css" rel="stylesheet" href="/lib/katex/katex.min.af6f85907cdfd6ed3e4906d93a8233d91c5638859f744cd1b98c9b1a3ccaab5f231bdcda49f132f6cdfe8cca86ff33ed468affab8a9a502610a664a34f0f0cfa.css" integrity="sha512-r2&#43;FkHzf1u0&#43;SQbZOoIz2RxWOIWfdEzRuYybGjzKq18jG9zaSfEy9s3&#43;jMqG/zPtRor/q4qaUCYQpmSjTw8M&#43;g==" />


<script defer src="/lib/katex/katex.min.20da6cf7343619410c0900fbc626506c65159ea9f312f9729d5cba7aa713707378f9a4222e8f7fb9a42a7240e9749f199b7334401b3e3e4b60e29cf490492552.js" integrity="sha512-INps9zQ2GUEMCQD7xiZQbGUVnqnzEvlynVy6eqcTcHN4&#43;aQiLo9/uaQqckDpdJ8Zm3M0QBs&#43;Pktg4pz0kEklUg=="></script>


<script defer src="/lib/katex/auto-render.min.6095714e3aadb63b14ddc4af69346ab12974c1b460654345f8d1860a0b68fcc51b22f68b757433193090bb80afc8965b65cb607e5541d0f5f0f4b2e64d69b9ff.js" integrity="sha512-YJVxTjqttjsU3cSvaTRqsSl0wbRgZUNF&#43;NGGCgto/MUbIvaLdXQzGTCQu4CvyJZbZctgflVB0PXw9LLmTWm5/w=="
  onload="renderMathInElement(document.body);"></script>







































































































































  
  


  
  
  <meta name="theme-color"/>
  
  
</head>
<body
  class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32">
  <div id="the-top" class="absolute flex self-center">
    <a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
      href="#main-content"><span
        class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a>
  </div>
  
  
  <div class="min-h-[148px]"></div>
<div class="fixed inset-x-0 pl-[24px] pr-[24px]" style="z-index:100">
  <div id="menu-blur" class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom bg-neutral dark:bg-neutral-800"></div>
  <div class="relative max-w-[64rem] ml-auto mr-auto">
    <div style="padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px"
    class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3">
    
    
    
    <div>
        <a href="/" class="flex">
            <span class="sr-only">Utkarsh Deoli</span>

            <img src="/nekonobg.png" width="250" height="250"
                class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom" alt="Utkarsh Deoli" />

        </a>
    </div>
    
    <div class="flex flex-1 items-center justify-between">
        <nav class="flex space-x-3">

            
            <a href="/" class="text-base font-medium text-gray-500 hover:text-gray-900">Utkarsh Deoli</a>
            

        </nav>
        <nav class="hidden md:flex items-center space-x-5 md:ml-12 h-12">

            
            
            
  <a href=""  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="">
        Projects
    </p>
</a>


            
            
  <a href=""  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="">
        Blog
    </p>
</a>


            
            
  <a href=""  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="">
        Contact
    </p>
</a>


            
            
  <a href="https://firebasestorage.googleapis.com/v0/b/utkarsh-deoli-portfolio.appspot.com/o/UtkarshDeoliCV%20%281%29.pdf?alt=media&amp;token=dbb3a0de-4dd5-4f17-a410-c1ceee191f75"  target="_blank"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="">
        Resume
    </p>
</a>


            
            
  <a href=""  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="">
        
    </p>
</a>


            
            

            


            


            
            
            <div
                class="ltr:mr-14 rtl:ml-14 flex items-center">
                <button id="appearance-switcher" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400">
                    <div class="flex items-center justify-center dark:hidden">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                    </div>
                    <div class="items-center justify-center hidden dark:flex">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                    </div>
                </button>
            </div>
            

        </nav>
        <div class="flex md:hidden items-center space-x-5 md:ml-12 h-12">

            <span></span>

            


            

            
            
            <button id="appearance-switcher-mobile" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400" style="margin-right:5px">
                <div class="flex items-center justify-center dark:hidden">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                </div>
                <div class="items-center justify-center hidden dark:flex">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                </div>
            </button>
            

        </div>
    </div>
    <div class="-my-2 -mr-2 md:hidden">

        <label id="menu-button" for="menu-controller" class="block">
            <input type="checkbox" id="menu-controller" class="hidden" />
            
            <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
                

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>

  </span>


            </div>
            <div id="menu-wrapper" style="padding-top:5px;"
                class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50">
                <ul
                    class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl">

                    <li>
                        <span
                            class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>

</span>
                    </li>

                    

                    
  <li class="mt-1">
    <a href=""  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            Projects
        </p>
    </a>
</li>



                    

                    
  <li class="mt-1">
    <a href=""  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            Blog
        </p>
    </a>
</li>



                    

                    
  <li class="mt-1">
    <a href=""  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            Contact
        </p>
    </a>
</li>



                    

                    
  <li class="mt-1">
    <a href="https://firebasestorage.googleapis.com/v0/b/utkarsh-deoli-portfolio.appspot.com/o/UtkarshDeoliCV%20%281%29.pdf?alt=media&amp;token=dbb3a0de-4dd5-4f17-a410-c1ceee191f75"  target="_blank"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            Resume
        </p>
    </a>
</li>



                    

                    
  <li class="mt-1">
    <a href=""  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            
        </p>
    </a>
</li>



                    

                </ul>
                
                

            </div>
        </label>
    </div>
</div>




<script>
    (function () {
        var $mainmenu = $('.main-menu');
        var path = window.location.pathname;
        $mainmenu.find('a[href="' + path + '"]').each(function (i, e) {
            $(e).children('p').addClass('active');
        });
    })();
</script>


  </div>
</div>
<script>
  window.addEventListener('scroll', function (e) {
    var scroll = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
    var background_blur = document.getElementById('menu-blur');
    background_blur.style.opacity = (scroll / 300);
  });
</script>

  
  <div class="relative flex flex-col grow">
    <main id="main-content" class="grow">
      


<article>
  
  
  
  
  
  




    
    <div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom"
    style="background-image:url(/articels/2023-12-10/feature_hue5693d15d474c4cb1cba1a868c130846_578744_1200x0_resize_q75_box.jpg);">
    


    <div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal">
    </div>
    <div
        class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal">
    </div>
</div>

<div id="background-blur" class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div>
<script>
    window.addEventListener('scroll', function (e) {
        var scroll = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
        var background_blur = document.getElementById('background-blur');
        background_blur.style.opacity = (scroll / 300)
    });
</script>

  
  

  <header id="single_header" class="mt-5 max-w-prose">
    
    <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
      读书笔记《大规模语言模型：从理论到实践》
    </h1>
    <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
      





  
  







  





  



  



  



  



  







<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2023-12-10 00:00:00 &#43;0000 UTC">10 December 2023</time><span class="px-2 text-primary-500">&middot;</span><span>1086 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">6 mins</span><span class="px-2 text-primary-500">&middot;</span><span>
  
  
    
    
      
      
        
        
      
      
    
  
  <span id="views_articels/2023-12-10/index.md" class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400" title="views">loading</span>
  <span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
<path fill="currentColor" d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg>
  </span>

</span>
</span><span class="px-2 text-primary-500">&middot;</span><span>
  
  
    
    
      
      
        
        
      
      
    
  
  <span id="likes_articels/2023-12-10/index.md"
    class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400"
    title="likes">loading</span>
  <span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
<path fill="currentColor" d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg>
  </span>

</span>
</span><span class="px-2 text-primary-500">&middot;</span><span>
    <button id="button_likes"
        class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400"
        onclick="process_article()">
        <span id="button_likes_heart" style="display:none" class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
<path fill="currentColor" d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg>
  </span>

 </span>
        <span id="button_likes_emtpty_heart" class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
<path fill="currentColor" d="M244 84L255.1 96L267.1 84.02C300.6 51.37 347 36.51 392.6 44.1C461.5 55.58 512 115.2 512 185.1V190.9C512 232.4 494.8 272.1 464.4 300.4L283.7 469.1C276.2 476.1 266.3 480 256 480C245.7 480 235.8 476.1 228.3 469.1L47.59 300.4C17.23 272.1 0 232.4 0 190.9V185.1C0 115.2 50.52 55.58 119.4 44.1C164.1 36.51 211.4 51.37 244 84C243.1 84 244 84.01 244 84L244 84zM255.1 163.9L210.1 117.1C188.4 96.28 157.6 86.4 127.3 91.44C81.55 99.07 48 138.7 48 185.1V190.9C48 219.1 59.71 246.1 80.34 265.3L256 429.3L431.7 265.3C452.3 246.1 464 219.1 464 190.9V185.1C464 138.7 430.4 99.07 384.7 91.44C354.4 86.4 323.6 96.28 301.9 117.1L255.1 163.9z"/></svg>
  </span>

</span>
        <span id="button_likes_text">&nbsp;Like</span>
    </button>
</span>
  

  
  
</div>







    </div>

    
    
    
    
    

    

    
      
      
        
        
<div class="flex author">
  
    
    
      
    
    
      
        
      
      <img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width="96" height="96"
      alt="Utkarsh Deoli" src="/20131113_054558_hu3c0fbd01a0e6baca8802d02a563621ff_1368799_192x192_fill_q75_box_center.jpg" />
    
  
  <div class="place-self-center">
    
    <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
      Author
    </div>
    <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
      Utkarsh Deoli
    </div>
    
    
    <div class="text-sm text-neutral-700 dark:text-neutral-400">Utkarsh Deoli -just a developer for fun</div>
    
    <div class="text-2xl sm:text-lg">
  <div class="flex flex-wrap text-neutral-400 dark:text-neutral-500">
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="mailto:utkarsh.deoli@gmail.com?subject=Contacting%20from%20your%20website"
          target="_blank"
          aria-label="Envelope"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4 0L492.8 150.4c12.1-9.1 19.2-23.3 19.2-38.4c0-26.5-21.5-48-48-48H48zM0 176V384c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V176L294.4 339.2c-22.8 17.1-54 17.1-76.8 0L0 176z"/></svg>
  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://github.com/UtkarshDeoli"
          target="_blank"
          aria-label="Github"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://www.linkedin.com/in/utkarshdeoli"
          target="_blank"
          aria-label="Linkedin"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>

  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://x.com/utkarshdeoli"
          target="_blank"
          aria-label="X-Twitter"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg>
  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://www.youtube.com/@utkarshdeoli"
          target="_blank"
          aria-label="Youtube"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentColor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>

  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://www.leetcode.com/sagemodeutkarsh"
          target="_blank"
          aria-label="Code"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512">
<path fill="currentColor"  d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6zm80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3L562.7 256l-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3z"/></svg>
  </span>

</span></a
        >
      
    
  </div>

</div>
  </div>
</div>

      

      

      
      <div class="mb-5"></div>
      

    

  </header>
  
  <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
    
    

      <div class="min-w-0 min-h-0 max-w-fit">
        
        


        <div class="article-content max-w-prose mb-20">
          


  



<div
  
    class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"
  >

  <span
    
      class="text-primary-400 ltr:pr-3 rtl:pl-3 flex items-center"
    >

    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M48 32H197.5C214.5 32 230.7 38.74 242.7 50.75L418.7 226.7C443.7 251.7 443.7 292.3 418.7 317.3L285.3 450.7C260.3 475.7 219.7 475.7 194.7 450.7L18.75 274.7C6.743 262.7 0 246.5 0 229.5V80C0 53.49 21.49 32 48 32L48 32zM112 176C129.7 176 144 161.7 144 144C144 126.3 129.7 112 112 112C94.33 112 80 126.3 80 144C80 161.7 94.33 176 112 176z"/></svg>

  </span>


  </span>

  <span
    
      class="dark:text-neutral-300"
    >本文主要是对<a href="https://intro-llm.github.io/chapter/LLM-TAP.pdf"   target="_blank">
    《大规模语言模型：从理论到实践》</a>的阅读笔记</span>
</div>



<h2 class="relative group">绪论 
    <div id="%E7%BB%AA%E8%AE%BA" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E7%BB%AA%E8%AE%BA" aria-label="Anchor">#</a>
    </span>        
    
</h2>


<h3 class="relative group">基本概念 
    <div id="%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p><strong>语言模型(Language Model，LM)</strong> 目标就是建模自然语言的概率分布。</p>
<blockquote>
<p>假设词汇表 \(\Bbb{V}\) 上的语言模型，由函数 \(P(w_1, w_2&hellip;w_m)\) 表示，可以构建为词序列\(w_1,w_2&hellip;w_m\) 的概率分布，表示词序列做作为一个句子出现的可能性大小，即\(P(w_1,w_2&hellip;w_m)=P(w_1)P(w_2|w_1)&hellip;P(w_m|w_1w_2&hellip;w_m-1) =\prod^m_{i=1}P(w_1|w_1w_2w_i-1)\)。</p>
</blockquote>
<p>上面的公式我们可以得知，第 \(i\) 个单词出现的概率与前面 \(i-1\) 个单词相关；如果按照《现代汉语辞掉 (第七版)》包含7万个单词，句子长度20个词(\(m=20\))计算，模型参数量达到\(7.9792 \times 10^{96}\)的天文数字。</p>
<p>为了简化简化模型，提出了<strong>n元语法</strong> 或 <strong>n元文法</strong> (n-gram)：在上述建模的基础上，进一步假设任一单词 \(w_i\) 出现的概率只与过去 \(n-1\) 个词相关。即：</p>
<p>$$
P(w_i|w_1w_2&hellip;w_{i-1}) = P(w_i|w_{i-(n-1)}w_{i-(n-2)}&hellip;w_{i-1})=P(w_i|w^{i-1}_{i-n+1})
$$</p>
<p>n-gram 将第 \(i\) 个单词的相关性从\(i-1\) 个单词减少到了\(n-1\) 个单词，同时也能缓解句子概率为0的问题但无法解决。为了从根本上解决出现零概率的问题，提出了<strong>平滑技术 (Smoothing)</strong>，对所有可能出现的字符串都分配一个非零的概率值。平滑处理最终会提高低概率、降低高概率，以此使整体的概率分布趋于均匀。这种使用n-gram+smoothing的方法被称为<strong>统计语言模型 (Statistical Language models，SLM)</strong>。</p>
<p>除了统计语言模型SLM这种方式外，基于 <em>分布式表示和神经网络的语言模型</em> 逐渐成为了主流。</p>
<p>首先会将一段文本通过 <strong>独热编码(one-hot)</strong> 映射为一个低维稠密的实数想来那个，称为<strong>词向量(Word Embedding)</strong>。基于词向量，再集合循环神经网络、卷积神经网络、端到端记忆网络等神经网络方法构建语言模型，这类方法通常称为<strong>神经语言模型 (Neural Language Models，NLM)</strong>。</p>
<p>直到以<strong>ELMo</strong>为代表的动态词向量模型的出现，才开启了语言模型预训练的大门。将预训练模型应用于下游任务时，不需要太多的任务细节，不需要设定特定的神经网络结构，只需要”微调”预训练模型，使用具体的标注数据在预训练模型上进行监督训练即可显著提升性能。这种方法被称为<strong>预训练语言模型(Pre-trained Language Models，PLM)</strong>。</p>
<p>在预训练语言模型的基础上，又提出了提示词(Prompt)、模型即服务范式(Maas)、指令微调(Instruction Tuning)等方法。</p>
<p>关于模型的定量分析，Kaplan 等人在文献中提出了缩放法则（Scaling Laws)，指出模型的性能依赖于模型的规模，包括：<em>参数数量</em>、<em>数据集大小</em> 和 <em>计算量</em>，模型的效果会随着三者的指数增加而线性提高。</p>


<h3 class="relative group">发展历程 
    <div id="%E5%8F%91%E5%B1%95%E5%8E%86%E7%A8%8B" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E5%8F%91%E5%B1%95%E5%8E%86%E7%A8%8B" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>对大模型的发展历程大体可以分为三个阶段：</p>
<ol>
<li>基础模型阶段 (2018-2021)：主要集中在语言模型本身，包括仅编码器(Encoder Only)、编码器-解码器(Encoder-Decoder)、仅解码器(Decoder Onlu)等具体的模型结构。通常采用预训练微调范式，针对不同下游任务进行微调。</li>
<li>能力探索阶段 (2019-2022)：2019年GPT-2模型研究了大规模语言模型在零样本情况下的任务处理能力。GPT-3模型上研究了利用语境学习(In-Context Learning)从而减少样本学习的方法。之后有研究员又提出了指令微调(Instruction Tuning)方案，将各类任务统一为生成式自然语言理解框架，并构造训练预料进行微调。2022年提出了使用有监督微调再结合强化学习方法。</li>
<li>突破发展阶段 (2022-至今)：从2022年11月 ChatGPT为起点，一个大模型语言模型就可以实现回答问题、文稿撰写、生成代码等不同种类的任务。2023年3月GPT-4发布后，具备了多模态的理解能力。</li>
</ol>
<p>




  
  
    
  
  
    <figure>
      
      <img
        class="my-0 rounded-md"
        loading="lazy"
        srcset="
        /articels/2023-12-10/images/Untitled_hu14f4d9455d7bfd5f2a20e31c4cb0f41d_33772_330x0_resize_box_3.png 330w,
        /articels/2023-12-10/images/Untitled_hu14f4d9455d7bfd5f2a20e31c4cb0f41d_33772_660x0_resize_box_3.png 660w,
        /articels/2023-12-10/images/Untitled_hu14f4d9455d7bfd5f2a20e31c4cb0f41d_33772_1024x0_resize_box_3.png 1024w,
        /articels/2023-12-10/images/Untitled_hu14f4d9455d7bfd5f2a20e31c4cb0f41d_33772_1320x0_resize_box_3.png 2x"
        src="/articels/2023-12-10/images/Untitled_hu14f4d9455d7bfd5f2a20e31c4cb0f41d_33772_660x0_resize_box_3.png"
        alt="Untitled"
      />
      
      
    </figure>
  

</p>


<h3 class="relative group">模型构建流程 
    <div id="%E6%A8%A1%E5%9E%8B%E6%9E%84%E5%BB%BA%E6%B5%81%E7%A8%8B" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E6%A8%A1%E5%9E%8B%E6%9E%84%E5%BB%BA%E6%B5%81%E7%A8%8B" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>大规模语言模型的构造分为预训练、有监督微调、奖励建模和强化学习4个流程</p>
<ul>
<li>预训练(Pretraining)：利用 <em>海量训练数据</em>，构建包含数千亿甚至数万亿单词的具有多样性的内容。</li>
<li>有监督微调(Supervised Finetuning)：也称为指令微调 (Instruction Tuning)。利用 <em>少量高质量数据集合</em>，包含提示词(Prompt)和对应的理想输出结果，使用与预训练阶段相同的语言模型训练算法，在基础语言模型基础上再训练，得到有监督微调模型(SFT模型)。</li>
<li>奖励建模 (Reward Modeling)：构建一个文本质量对比模型，对于同一个提示词Prompt，SFT模型会给出多个不同输出，对输出结果的质量进行排序。奖励模型(RM)通过二分类模型，对输入的两个结果进行判断。RM的准确率通常需要大规模的训练数据，且需要消耗大量的标注人员和非常详细的标注规范。</li>
<li>强化学习 (Reinforcement Learning)：根据用户给出的提示词，利用RM模型，给出SFT模型对用户提示词不全结果的质量评估，并于语言模型建模目标综合得到更好的效果。</li>
</ul>
<p>




  
  
  
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/Untitled%201.png" alt="Untitled" />
      
    </figure>
  

</p>


<h2 class="relative group">大预言模型基础 
    <div id="%E5%A4%A7%E9%A2%84%E8%A8%80%E6%A8%A1%E5%9E%8B%E5%9F%BA%E7%A1%80" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E5%A4%A7%E9%A2%84%E8%A8%80%E6%A8%A1%E5%9E%8B%E5%9F%BA%E7%A1%80" aria-label="Anchor">#</a>
    </span>        
    
</h2>


<h3 class="relative group">Transformer 模型 
    <div id="transformer-%E6%A8%A1%E5%9E%8B" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#transformer-%E6%A8%A1%E5%9E%8B" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Transformer 模型是谷歌在2017年提出的应用于机器翻译的神经网络模型结构，目标是从源语言转换到目标语言，通过注意力机制完成对源语言序列和目标语言序列全局依赖的建模。</p>
<p>当前几乎全部大于要模型都是基于Transformer结构。</p>
<p>Transformer的完成结构由若干Transformer块 (Block) 组成，每个块的输入对应一个向量序列\({x_i}^t_{i=1}\)，输出对应一个等长的向量序列\({y_i}^t_{i=1}\)，即文本序列中的一个单词的向量表示。</p>
<p>每个Block块的内部包含了<strong>编码器(Encoder)<strong>和</strong>解码器(Decoder)</strong>，编码器和解码器中均包含了以下4个部分</p>
<ul>
<li>注意力层：多头注意力 (Multi-Head Attention) 可以整和上下文语义，使得序列中任一两个单词之间的依赖关系可以直接被建模而不基于传统的循环结构，从而更好地解决文本的长程依赖</li>
<li>位置感知前馈层 (Position-wise FFN)：通过全连接层输入对文本序列中的每个单词进行复杂变换</li>
<li>残差连接：图中的Add部分。作用于注意力层和前馈层的中的直连通路，被用于连接它们的输入和输出。从而使得信息流动更高效，有利于模型的优化</li>
<li>层归一化：图中的Norm部分，用于注意力层和前馈层的输出表示序列中，对表示序列进行层归一化操作，起到稳定优化的作用</li>
</ul>
<p>




  
  
  
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/Untitled%202.jpeg" alt="Untitled" />
      
    </figure>
  

</p>
<p>下面按流程依次简单介绍各个模块的作用</p>
<p>首先进入的是 <strong>嵌入表示层</strong>，对于输入的文本序列，嵌入层(<em>Input Embedding</em>) 将每个单词转换为其相对应的向量表示。Transformer模型会在词嵌入中加入<strong>位置编码</strong>(<em>Positional Encoding</em>)，用于表示模型单词之间的位置关系。为了得到不同位置的编码，Transformer 模型使用不同频率的正余弦函数，其中 \(pos\) 表示单词所在的位置，\(2i\) 和 \(2i+1\) 表示位置编码向量中的对应维度，\(d\) 表示对应位置编码的总维度：</p>
<p>$$
PE(pos, 2i) = sin(\frac{pos}{1000^{2i/d}}) \space\space\space\space\space\space PE(pos,2i+1)=cos(\frac{pos}{1000^{2i/d}})
$$</p>
<p>得到了词嵌入和位置编码后，我们会进入<em><em>自注意力(<em><strong>Self Attention</strong></em>)<strong>模块。他是Transformer模型中的基本操作，在源语言的编码和目标语言的生成中频繁地被使用以建模源语言、目标语言中任意两个单词之间的依赖关系。例如：定义一个由 <em>单词语义嵌入和位置编码叠加</em> 得到的输入表示\({x_i \in \R^d}^t_{i=1}\)，通过三个三个</strong></em>线性变换</em>** \(W^Q \in \R^{d<em>d_q}\)、\(W^K \in \R^{d</em>d_k}\)、\(W^V \in \R^{d<em>d_v}\)，可以得到多注意力机制中需要的三个元素：查询 \(q_i\) (Query)、键 \(k_i\) (Key)、值 \(v_i\) (Value)，这三个权重反映了在编码当前单词的表示时，针对上下文不通部分所需要的关注程度。序列中不同单词的\(q、k、v\) 向量又可以拼接成对应矩阵\(Q \in \R^{L</em>d_q}、K \in \R^{L^D_K}、V \in \R^{d<em>d_v}\)，L表示序列程度。通过这三个矩阵我们最终可以得到\(Z \in \R^{L</em>d_v}\) ，它就是自注意力操作的输出。具体的公式如下，其中\(\sqrt{d}\) 是缩放因子：</p>
<p>$$
Z = Attention(Q,K,V)=Softmax(\frac{QK^T}{\sqrt{d}})V
$$</p>
<blockquote>
<p>为了进一步增强自注意力机制聚合上下文信息的能力，提出了 <strong>多头注意力</strong>(<em>Multi-head Attention</em>) 机制，换言之，上下文中的每一个单词表示，经过多组线性\({W^Q_jW^K_jW^V_j}^N_{j=1}\) 映射到不同的表示子空间，并在不同的子空间中分别计算并得到不同的上下文相关的单词序列表示\({Z_j}^N_{j=1}\)，最终可以综合得到不同子空间中的上下文表示。</p>
</blockquote>
<p>再之后我们会来到<strong>残差连接</strong>(<em>Add</em>)和<strong>层归一化</strong>(<em>Norm</em>)，这一步主要是为了提升训练的稳定性、缓解不稳定和收敛速度慢等问题。具体来说，残差连接主要是使用一条直连通道将对应子层的输入连接到输出上去，从而避免由于网络过深导致的梯度消失问题；层归一化用于将数据平移缩放到均值为0、方差为1的标准分布。</p>
<p><strong>前馈层</strong>(<em>Position-wise FFN</em>) 接受了来自自注意力子层的输出，并通过一个带有 \(Relu\) 激活函数的两层全连接网络对输入进行更加复杂的<em><strong>非线性变换</strong></em>。公式如下，其中\(W_1、b_1、W_2、b_2\) 均是表示前馈子层的参数。前馈子层隐状态的维度一般比自主力层要大。</p>
<p>$$
FFN(x) = Relu(xW_1+b_1)W_2 + b_2
$$</p>
<p>编码器主要是由上面这几部分构成的，解码器端会更复杂一些。解码器的每个 Transformer 快的第一个自注意力子层额外增加了<strong>掩码多头注意力</strong>(<em>Masked Multi-Head Attention</em>)部分。主要原因是，编码器的源语言序列信息是已知的，可以处理上下文语义，但是目的语言序列信息是未知的，对于每一个单词的生成，仅能当前单词之前的语言序列是已知的，即只有上文没有下文。所以额外增加的掩码是用来<em>掩盖后续的文本信息</em>，以防模型在训练阶段看到后续文本序列。</p>
<p>和编码器<strong>多头注意力</strong>不同的是，解码器的<strong>多头注意力</strong>(<em>Multi-Head Attention</em>)模块使用的是<strong>交叉注意力</strong>(<em>Cross-attention</em>)方法：同时<em>接受编码器的输出和掩码注意力层的输出</em>，即在每个时间\(t\)，根据编码器端输出的源语言文本表示，以及前\(t-1\)个时刻生成的目标语言文本，以 <em>自回归</em> 的方式生成当前时刻的目标语言单词。</p>


<h3 class="relative group">生成式预训练语言模型 GPT 
    <div id="%E7%94%9F%E6%88%90%E5%BC%8F%E9%A2%84%E8%AE%AD%E7%BB%83%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B-gpt" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E7%94%9F%E6%88%90%E5%BC%8F%E9%A2%84%E8%AE%AD%E7%BB%83%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B-gpt" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>OpenAI 在2018年提出了<strong>生成式的预训练语言模型</strong>(<em>Generative Pre-Training, GPT</em>) 是典型的生成式预训练语言模型之一。模型结构是由多层 Transformer 组成的单向语言模型，主要分为输入层、编码层和输出层三部分。</p>
<p><strong>预训练</strong>语言模型利用丰富的训练语料、自监督的预训练任务和Transformer等深度神经网络结构，使模型具备了通用且强大的自然语言表示能力；应用于下游任务时，只需要<strong>微调</strong>预训练模型，用具体任务的标注数据进行监督训练，就可以取得显著的性能提升</p>


<h4 class="relative group">无监督预训练 
    <div id="%E6%97%A0%E7%9B%91%E7%9D%A3%E9%A2%84%E8%AE%AD%E7%BB%83" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E6%97%A0%E7%9B%91%E7%9D%A3%E9%A2%84%E8%AE%AD%E7%BB%83" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>




  
  
  
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/Untitled%203.jpeg" alt="Untitled" />
      
    </figure>
  

</p>
<p>单向意味着模型只能从左到右或从右到左对文本序列建模，采用的Transformer 结构和解码策略保证了输入文本每个位置只能依赖于过去时刻的信息。</p>
<p>给定文本序列\(w = w_1w_2&hellip;w_n\)，GPT先在输入层将其映射为稠密向量，其中\(v_i^t\)是词\(w_i\)的词向量，\(v_i^p\)是词\(w_i\)的位置向量</p>
<p>$$
v_i = v_i^t + v_i^p
$$</p>
<p>将\(v=v_1v_2&hellip;v_n\)送变模型编码层，经过L个Transformer模块后，每一层的每个表示向量都会包含之前位置表示向量的信息，使得每个表示向量都具备丰富的上下文信息，最终得到每个单词层次化的组合式表示。GPT模型的输出层只基于最后一层的表示 \(h^{(L)}\) ，预测每个位置上的条件概率，计算过程可以表示为，其中\(W^e\)是词向量矩阵</p>
<p>$$
P(w_i|w_1,w_2,&hellip;,w_{i-1})=Softmax(W^eh_i^{(L)} + b^{out})
$$</p>
<p>单向语言模型是按照阅读顺序输入文本序列\(w\)，用常规语言模型目标优化\(w\)的最大似然估计，使它能根据输入历史序列对当前词做出准确预测，公式如下，其中\(\theta\)代表模型参数</p>
<p>$$
L^{pt}(w) = -\sum_{i=1}^nlogP(w_i|w_1w_2&hellip;w_{i-1};\theta)
$$</p>


<h4 class="relative group">有监督下游任务微调 
    <div id="%E6%9C%89%E7%9B%91%E7%9D%A3%E4%B8%8B%E6%B8%B8%E4%BB%BB%E5%8A%A1%E5%BE%AE%E8%B0%83" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E6%9C%89%E7%9B%91%E7%9D%A3%E4%B8%8B%E6%B8%B8%E4%BB%BB%E5%8A%A1%E5%BE%AE%E8%B0%83" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>通过上面的无监督预训练，GPT模型具备了一定的通用语义表示能力，下游任务微调(<em>Downstream Task Fine-tuning</em>) 是在这个基础上，根据下游任务的特性进行适配。下游任务通常需要有标注数据集进行训练，数据集合使用 \(\mathbb{D}\) 表示，每个样例由输入长度为\(n\)的文本序列\(x=x_1x_2&hellip;x_n\)和对应的标签 \(y\) 构成，对整个数据集精调后得到：</p>
<p>$$
L^{FT}(\mathbb{D})=-\sum_{(x, u)}logP(y|x_1x_2&hellip;x_n)
$$</p>
<p>需要注意的一点事，下游任务微调很容易使得模型遗忘预训练阶段所学习到的通用语义知识表示，从而损失模型的通用性和泛化能力，造成<strong>灾难性遗忘(Catastrophic Forgetting)</strong>。实际使用中，通常采取如下公式进行微调，其中\(\lambda\)的取值是\([0,1]\)，用于调节预训练任务损失占比：</p>
<p>$$
L =L^{FT}(\mathbb{D}) + \lambda L^{PT}(\mathbb{D})
$$</p>


<h3 class="relative group">大模型语言结构 
    <div id="%E5%A4%A7%E6%A8%A1%E5%9E%8B%E8%AF%AD%E8%A8%80%E7%BB%93%E6%9E%84" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E5%A4%A7%E6%A8%A1%E5%9E%8B%E8%AF%AD%E8%A8%80%E7%BB%93%E6%9E%84" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>目前大多数的大语言模型都采用了类似GPT的架构，基于Transformer架构构建的仅由解码器组成的网络结构，采用自回归的方式构建语言模型。但是在<strong>位置编码</strong>、<strong>层归一化位置</strong>以及<strong>激活函数</strong>等细节上各有不同。</p>


<h4 class="relative group">LLaMA 的模型结构 
    <div id="llama-%E7%9A%84%E6%A8%A1%E5%9E%8B%E7%BB%93%E6%9E%84" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#llama-%E7%9A%84%E6%A8%A1%E5%9E%8B%E7%BB%93%E6%9E%84" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>以 LLaMA模型为例，与GPT架构不同的是采用了前置层归一化(Pre-normaliztion)并使用RMSNorm归一化函数(Normalizing Function)、激活函数更换为SwiGLU，并使用了旋转位置嵌入 (RoP)，架构类似于GPT-2。</p>
<p>




  
  
  
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/Untitled%204.jpeg" alt="Untitled" />
      
    </figure>
  

</p>
<ul>
<li>
<p>前置层归一化：为了使模型训练过程更加稳定，引入了前置归一化，即将归一化移动到多头自注意力层和全连接层之前，同时残差链接的位置仍在自注意力层和全连接层之后。</p>
</li>
<li>
<p>RMSNorm归一化函数：除了归一化的位置提前外， 层归一化中也采用了RMSNorm归一化函数，归一化函数可以提供更稳定的梯度。计算公式如下，其中 \(g_i\) 是缩放因子，\(b_i\) 是偏移参数</p>
<p>$$
RMS(a) = \sqrt{\frac{1}{n}\textstyle\sum^n_{i=1}a^2_i} \ \overset{-}{a}_i = \frac{a_i}{RMS(a)}g_i + b_i
$$</p>
</li>
<li>
<p>SwiGLU 激活函数：在全连接层使用 SwiGLU激活函数替换ReLU函数，相较于 ReLU 函数在大部分评测中都有不少提升。在LLaMA中全连接层使用带有 SwiGLU 激活函数的FFN (Position-wise Feed-Forward Network) 的计算公式如下，其中 \(\sigma(x)\) 是 \(Sigmoid\) 函数：</p>
<p>$$
FNN_{SwiGLU}(x, W, V, W_2) = SwiGLU(x, W,V)W_2
$$
$$
SwiGLU(x,W,V)=Swish_{\beta}(xW) \otimes xV
$$
$$
Switsh_\beta(x)=x\sigma (\beta x)
$$</p>
<ul>
<li>当 \(\beta\) 趋近于 \(0\) 时，\(Swish\) 函数趋近于线性函数 \(y =x\)</li>
<li>当 \(\beta\) 趋近于 \(1\) 时，\(Swish\) 函数是光滑且非单调的</li>
<li>当 \(\beta\) 趋近于\(+\infty\)时，\(Swish\) 函数趋近于 \(ReLU\) 函数</li>
</ul>
</li>
<li>
<p>RoPE 旋转位置嵌入：在位置编码上，使用旋转位置嵌入 (Rotary Positional Embeddings，RoPE) 代替原有的绝对位置编码。RoPE 借助了 <strong>复数</strong> 的思想，通过绝对位置编码的方式实现相对位置编码，目标是 给\(q\)，\(k\) 添加绝对位置信息，经过如下操作后 \(\overset{-}{q}_m\)  和 \(\overset{-}{k}_n\) 就带有位置 m 和 n 的绝对位置信息：</p>
<p>$$
\overset{-}{q}_m = f(q, m) \space\space\space\space\space\space \overset{-}{k}_n=f(k, n)
$$</p>
</li>
</ul>


<h4 class="relative group">注意力机制优化 
    <div id="%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6%E4%BC%98%E5%8C%96" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6%E4%BC%98%E5%8C%96" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>Transformer 结构中，自注意力机制的事件和存储复杂度与序列的长度呈平方的关系。因此占用了大两算力。一些研究从近似注意力触发，减少计算和内存需求，提出了稀疏今夕、低秩近似等方法；另一方面从计算加速设备本身出发，研究如何更好地利用硬件特性。</p>
<p><strong>稀疏注意力机制</strong></p>
<p>通过对训练好的 Transformer 模型中的注意力矩阵分析发现，很多通常是稀疏的，所以可以通过限制 Query-Key 对儿的数量来减少计算复杂度。这类方法称之为<strong>稀疏注意力</strong> (Sparse Attention) 机制，稀疏化方法进一步可以分成两类：基于 <em>位置信息</em> 和 <em>基于内容</em>。</p>
<p>基于内容的稀疏注意力机制的基本类型主要有以下5种：</p>
<ol>
<li>全局注意力 (Global Attention)：为了增强模型建模长距离依赖关系，可以加一些全局节点</li>
<li>带状注意力 (Band Attention)：大部分数据都带有局部性，限制Query只与相邻的几个节点进行交互</li>
<li>膨胀注意力 (Dilated Attention)：通过增加空隙以获取更大的感受野 (神经网络中一个神经元”看到的”输入区域)</li>
<li>随机注意力 (Random Attention)：通过随机采样，提升非局部的交互</li>
<li>局部块注意力 (Block Local Attention)：使用多个不重叠的块来限制信息交互</li>
</ol>
<p>




  
  
  
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/Untitled%205.jpeg" alt="Untitled" />
      
    </figure>
  

</p>
<p><strong>FlashAttention</strong></p>
<p>GPU的显存分为全局内存(Global Memory)、本地内存(Local  Memory)、共享内存(Shared  Memory)、寄存器内存(Register  Memory)、常量内存(Constant  Memory)、纹理内存(Texture  Memory)等六大类。全局内存、本地内存、共享内存和寄存器内存具有读写能力，具体区别如下：</p>
<ul>
<li>容量方面，<strong>全局内存</strong>和<strong>本地内存</strong>使用的高带宽显存(High Bandwidth  Memory, HBM)位于板卡的 <em>RAM存储芯片</em> 上，该部分内存容量大；<strong>共享内存</strong>和<strong>寄存器内存</strong>位于<em>GPU芯片</em>上，内存容量很小</li>
<li>访问权限方面，<strong>全局内存</strong>所有线程可访问，<strong>本地内存</strong>只能当前线程访问，<strong>共享内存</strong>只有一个GPU线程块(Thread Block)内的线程可以访问，<strong>寄存器内存</strong>仅限同一个线程内部才能访问</li>
<li>访问速度方面，<strong>共享内存</strong>的访问速度远高于<strong>全局内存</strong>的访问速度</li>
</ul>
<p>




  
  
  
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/Untitled%206.jpeg" alt="Untitled" />
      
    </figure>
  

</p>
<p>基于GPU的内存结构，<strong>FlashAttention</strong>通过利用GPU硬件中的特殊设计，针对全局内存和共享存储的I/O速度不同，尽可能地避免从 HBM 中读取或写入注意力矩阵，尽可能高效地使用 SRAM 来加快计算速度，避免从全局内存中读取和写入矩阵。具体的实现方式是：在不访问整个输入的情况下计算  \(Softmax\) 函数，并向后传播中不能存储中间过程的注意力矩阵。</p>
<p>这里使用到了 <strong>多查询注意力 (Multi Query Attention)</strong>—— 在多查询注意力中不同的注意力头共享一个键值集合，每个头只单独保留一份查询参数。因此键值矩阵仅有一份，大幅较少了显存占用，同时将这份键值矩阵在SRAM上进行读写，如下图:</p>
<p>




  
  
  
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/Untitled%207.jpeg" alt="Untitled" />
      
    </figure>
  

</p>


<h2 class="relative group">语言模型训练数据 
    <div id="%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E8%AE%AD%E7%BB%83%E6%95%B0%E6%8D%AE" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E8%AE%AD%E7%BB%83%E6%95%B0%E6%8D%AE" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>关于数据来源这里只做简单的描述，大数据模型训练所需的数据来源大体可以分为通用数据和专业数据两类。通用数据包括网页、图书、新闻、对话文本等，数据规模大且多样，提供语言建模和泛化能力；专业数据包括多语言、科学、代码等等，提供大模型的任务解决能力。下图给出一些典型大模型使用的数据分布：</p>
<p>




  
  
  
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/Untitled%208.jpeg" alt="Untitled" />
      
    </figure>
  

</p>


<h3 class="relative group">数据处理 
    <div id="%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>典型的数据处理过程包含质量过滤、荣誉去除、隐私消除、词元切分等几个步骤</p>
<p>




  
  
  
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/Untitled%209.jpeg" alt="Untitled" />
      
    </figure>
  

</p>
<ul>
<li>质量过滤：过滤低质量数据，过滤方法大致可以分为：基于<strong>分类器</strong>的方法和基于<strong>启发式</strong>的方法
<ul>
<li>基于分类器的方法：训练文本质量模型，并利用该模型识别并过滤低质量数据</li>
<li>基于启发式的方法：通过一组精心设计的规则来消除低质量文本，具体包括
<ul>
<li>语言过滤：进关注一种或几种语言，可以过滤其他语言文本</li>
<li>指标过滤：利用评测指标过滤，通过语言模型对给定文本的困惑度(Perplexity)，过滤掉非自然的句子</li>
<li>统计特征过滤：针对文本内容计算包括标点符号分布、符号子比句子长度等统计特征</li>
<li>关键词过滤：特定关键词集，识别和删除文本中的噪声和无用元素</li>
</ul>
</li>
</ul>
</li>
<li>冗余去除：去除文本中的重复数据，第一步是进行文本冗余发现(Text Duplicate Detection)，目标是发现不同粒度上的文本重复，包括句子、段落以及文档等不同级别。文档级别大部分是依靠文档之间的表面相似度(如 n-gram 重叠比例)进行检测并删除重复文档。</li>
<li>隐私消除：最直接的方法是基于规则的算法，利用命名实体识别算法检测姓名、地址、电话等隐私信息</li>
<li>词元切分：将原始文本分割成词元(Token)序列，其中比较重要的部分就是 <em>如何维护词表</em>。首先模型会依赖预先约定的词表 \(\mathbb{V}\)，编码训练时只处理词表中存在的词，如何解决未登录的词，即词元分析是至关重要的，词元表示模型正式用于此。具体的词元表示模型有：
<ul>
<li>字节对编码(Byte Pair Encoding, BPE)模型 ，该模型所采用的此表包含最常见的单词以及高频出现的子词，常见词通常本身位于BPE词表，而罕见词通常被分解为若干包含在BPE词表中的词元，从而大幅降低未登录词的比例。</li>
<li>WordPiece：首先训练一个语言模型，并用该语言模型对所有可能词元进行评分，在每次合并时，选择使得训练数据似然概率增加最多的词元对。</li>
</ul>
</li>
</ul>


<h3 class="relative group">数据影响分析 
    <div id="%E6%95%B0%E6%8D%AE%E5%BD%B1%E5%93%8D%E5%88%86%E6%9E%90" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E6%95%B0%E6%8D%AE%E5%BD%B1%E5%93%8D%E5%88%86%E6%9E%90" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>这里我们直接贴结论：</p>
<ul>
<li>数据规模方面，研究发现模型只需要约10M到100M个单词的训练，就可以可靠地获得语法和语义特征，但是需要更多的数据量才能获得足够的常识知识和其他技能，并在典型下游自然语言理解任务中取得较好的结果。如果模型训练要达到计算最优（Compute-optimal），模型大小和训练词元数量应该等比例缩放，模型大小加倍则训练词元数量也应该加倍。</li>
<li>数据质量方面，大量重复的低质量数据甚至导致训练过程不稳定，造成模型训练不收敛。现有的研究表明训练数据的构建时间、包含噪音或有害信息情况以及数据重复率等因素，都对语言模型性能存在较大影响。所以语言模型在经过清洗的高质量数据上训练数据可以得到更高的性能。</li>
<li>数据多样性方面，来自不同领域、使用不同语言、应用于不同场景的训练数据具有不同的语言特征，包含不同雨一直是，可以使大预言模型获得更广泛的知识。</li>
</ul>


<h2 class="relative group">分布式训练 
    <div id="%E5%88%86%E5%B8%83%E5%BC%8F%E8%AE%AD%E7%BB%83" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E5%88%86%E5%B8%83%E5%BC%8F%E8%AE%AD%E7%BB%83" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>分布式训练 (Distributed Training) 是指将机器学习或深度学习模型训练任务分解成多个子任务，并在多个计算设备上并行地进行训练。</p>
<p>随着CPU的算力增加已经远低于摩尔定律 (Moore’s Law)，虽说计算加速设备GPU、TPU等为机器学习模型提供了大量算力，但是其增长速度仍然没有突破每18个月翻倍的摩尔定律，为了满足机器学习模型的发展，只有通过分布式训练系统才可以匹配模型不断增长的算力需求。</p>
<p>




  
  
  
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/Untitled%2010.jpeg" alt="Untitled" />
      
    </figure>
  

</p>
<p>总训练速度可以用如下公式简略估计：</p>
<p>$$
\footnotesize 总训练速度\propto 单设备计算速度 \times 计算设备总量 \times 多设备加速比
$$</p>


<h3 class="relative group">分布式训练并行策略 
    <div id="%E5%88%86%E5%B8%83%E5%BC%8F%E8%AE%AD%E7%BB%83%E5%B9%B6%E8%A1%8C%E7%AD%96%E7%95%A5" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E5%88%86%E5%B8%83%E5%BC%8F%E8%AE%AD%E7%BB%83%E5%B9%B6%E8%A1%8C%E7%AD%96%E7%95%A5" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>并行策略大体可以分为三类</p>
<ul>
<li>
<p>数据并行：对数据进行切片，并同一个模型复制到多个设备上，并行执行不同分片</p>
<p>




  
  
  
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/Untitled%2011.jpeg" alt="Untitled" />
      
    </figure>
  

</p>
</li>
<li>
<p>模型并行：对模型进行划分，将模型中的算子分发到多个设备分别完成，Transformer结构主要有三种算子——嵌入式表示 (Embedding)、矩阵乘 (MatMul) 和交叉熵损失(Cross Entropy Loss)。针对这三种算子，又有两种划分方式：</p>
<ul>
<li>流水线并行：按模型的层切分到不同设备，即层间并行或算子间并行</li>
<li>张量并行：将计算图层内的参数切分到不同设备，即层内或算子内并行</li>
</ul>
</li>
</ul>
<p>




  
  
  
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/Untitled%2012.jpeg" alt="Untitled" />
      
    </figure>
  

</p>
<ul>
<li>混合并行：同时对数据和模型进行切分。比较典型的例子是 BLOOM 模型使用Megatron-DeepSpeed框架训练，主要包含两个部分：
<ul>
<li>Megatron-LM 提供了张量并行能力和数据加载原语</li>
<li>DeepSpeed 提供 ZeRO 优化器、模型流水线以及常规的分布式训练组件</li>
</ul>
</li>
</ul>
<p>




  
  
  
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/Untitled%2013.jpeg" alt="Untitled" />
      
    </figure>
  

</p>


<h3 class="relative group">分布式训练的集群架构 
    <div id="%E5%88%86%E5%B8%83%E5%BC%8F%E8%AE%AD%E7%BB%83%E7%9A%84%E9%9B%86%E7%BE%A4%E6%9E%B6%E6%9E%84" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E5%88%86%E5%B8%83%E5%BC%8F%E8%AE%AD%E7%BB%83%E7%9A%84%E9%9B%86%E7%BE%A4%E6%9E%B6%E6%9E%84" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>分布式集群的瓶颈主要集中在两点：网络带宽和设备带宽。</p>
<p>针对网络带宽，通常采用胖树(Flat-Tree)的拖布结构，试图实现网络带宽的无收敛。此外，采用 InfiniBand (IB) 技术搭建高速网络，单个 IB 链路可提供 200Gb/s 或 400Gb/s 的带宽。NVIDIA的DGX服务器提供单机 1.6Tb (200Gb\(\times\)8) 网络带宽，HGN 服务器网络带宽可以达到3.2Tb (400Gb\(\times\)8) 带宽、</p>
<p>针对计算加速设备之间的通信带宽，PCIe 5.0 总线只能提供 128GB/s 的带宽，而NVIDIA H100 采用高带宽内存 (High-Bandwidth Memory, HBM) 可以提供 3350GB/s 的带宽。多个 H100 GPU 之间采用了NVLink 和 NVSwitch (NVLink交换机)，使得任何 H100 GPU 之间可以达到 900GB/s 的双向通信速度。</p>
<p>在解决了带宽问题后，在由高速网络组成的高性能计算上构建分布式训练系统，常见的主要有两种常见架构：</p>
<ul>
<li>
<p>参数服务器架构 (Parameter Server, PS)：参数服务器提供充足内存和通信资源，训练服务器提供大量的计算资源。每个训练服务器都拥有完整模型，并根据分配到此服务的训练数据集切片进行计算，将得到的梯度推送到相应的参数服务器。参数服务器会等待多个训练服务器都完成梯度推送，然后开始计算平均梯度，并更新参数，之后通知训练服务器拉取最新参数，并开始下一轮训练迭代。</p>
<p>




  
  
  
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/Untitled%2014.jpeg" alt="Untitled" />
      
    </figure>
  

</p>
</li>
<li>
<p>去中心化架构 (Decentralized Network)：采用集合通信实现分布式训练系统，节点之间需要周期性地交换参数更新和梯度信息，可以减少通信瓶颈，提供系统的可拓展性。常用的通信原语包括 Broadcast、Scatter、Reduce、All-Reduce、Gather、All-Gather、Reduce-Scatter、All-to-All等。</p>
</li>
</ul>
<p>




  
  
  
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/Untitled%2015.jpeg" alt="Untitled" />
      
    </figure>
  

</p>


<h2 class="relative group">有监督微调 
    <div id="%E6%9C%89%E7%9B%91%E7%9D%A3%E5%BE%AE%E8%B0%83" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E6%9C%89%E7%9B%91%E7%9D%A3%E5%BE%AE%E8%B0%83" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>有监督微调(Supervised Finetuning, SFT) 又称 指令微调 (Instruction Tuning)，是指在已经训练好的语言模型的基础上，通过使用有标注的特定任务数据进行进一步微调，从而使得模型具备遵循指令的能力。</p>


<h3 class="relative group">提示学习和语境学习 
    <div id="%E6%8F%90%E7%A4%BA%E5%AD%A6%E4%B9%A0%E5%92%8C%E8%AF%AD%E5%A2%83%E5%AD%A6%E4%B9%A0" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E6%8F%90%E7%A4%BA%E5%AD%A6%E4%B9%A0%E5%92%8C%E8%AF%AD%E5%A2%83%E5%AD%A6%E4%B9%A0" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>提示学习(Prompt-based Learning) 是直接利用在大量原始文本上进行预训练的语言模型，并通过定义一个新的提示函数，使得模型能够执行小样本甚至零样本学习，以适应仅有少量标注或没有标注数据的新场景。提示学习完成预测的过程可以分为三个阶段：</p>
<ol>
<li>提示添加：借助特定的模板，将原始文本和额外添加的提示拼接起来，一并输入到语言模型中。</li>
<li>答案搜索：将构建好的提示整体输入语言模型后，根据模板可以得到多个预测文本，找到预测得分最高的文本 \(\hat{z}\)。</li>
<li>答案映射：得到的 \(\hat{z}\) 并不一定是最终的标签，在分类任务还需要将模型输出与最终标签做映射，这些映射是人为制定的。</li>
</ol>
<p>语境学习 (Incontext Learning, ICL) 也称上下文学习，指模型可以从上下文中的几个例子中学习：向模型输入特定任务的一些具体例子 (Demonstration) 以及要测试的样例，模型可以根据给定的示例续写出测试样例的答案。</p>


<h3 class="relative group">高效模型微调 (LoRA) 
    <div id="%E9%AB%98%E6%95%88%E6%A8%A1%E5%9E%8B%E5%BE%AE%E8%B0%83-lora" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E9%AB%98%E6%95%88%E6%A8%A1%E5%9E%8B%E5%BE%AE%E8%B0%83-lora" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>由于大模型参数量十分庞大，当将其应用到下游任务时，微调全部参数需要想到高的算力。为了节省成本，研究人员提出了多种参数高效的微调方法，旨在仅训练少量参数使得模型适应到下游任务。具体的微调方法有Lora、P-tuning、Adapter等等。本节具体以 LoRA (Low-Rank Adaptation of Large Language Models) 为例。</p>
<p>研究认为参数更新量即使投影到较小的子空间中，也不会影响学习的有效性。因此，提出固定预训练模型参数不变，在原本权重矩阵旁路添加低秩矩阵的乘积作为可训练参数，用以模拟参数的变化量。</p>
<p>假设预训练权重位 \(W_0 \in \R^{d<em>k}\)，可训练参数为 \(\Delta W = BA\)，其中\(B \in \R^{d</em>r}\)，\(A \in \R^{r*d}\)。初始化时，矩阵\(A\) 通过高斯函数初始化，矩阵 \(B\) 为零初始化，使得训练开始之前旁路对元模型不造成影响。对于权重的输入\(x\) ，LoRA 方式的计算流程如下</p>
<p>$$
h =W_0x + \Delta Wx = W_0x + BA_x
$$</p>
<p>




  
  
  
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/Untitled%2016.jpeg" alt="Untitled" />
      
    </figure>
  

</p>


<h3 class="relative group">上下文窗口扩展 
    <div id="%E4%B8%8A%E4%B8%8B%E6%96%87%E7%AA%97%E5%8F%A3%E6%89%A9%E5%B1%95" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E4%B8%8A%E4%B8%8B%E6%96%87%E7%AA%97%E5%8F%A3%E6%89%A9%E5%B1%95" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>以 LLaMA 模型为例，其规定输入的文本的词元数量不得超过 2048 个，但这会限制模型对于长文本的理解和表达能力。为了更好地满足长文本需求，需要扩展语言模型的长文本建模能力，具体的方法有：</p>
<ul>
<li>
<p>增加上下文窗口的微调：使用一个更长的上下文窗口来微调现有的预训练 Transformer，以适应长文本建模需求</p>
</li>
<li>
<p>位置编码：改进的位置编码，如 ALiBi、LeX等实现一定程度上的长度外推，使它们可以在短的上下文窗口进行训练，在长的上下文窗口进行推理。例如 ALiBi 算法，在 Softmax 的结果后添加一个静态的不可学习配置项</p>
<p>$$
Softmax(q_iK^T + m[-(i-1),&hellip;,-2,-1,0])
$$</p>
<p>




  
  
  
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/Untitled%2017.jpeg" alt="Untitled" />
      
    </figure>
  

</p>
</li>
<li>
<p>插值法：将超出上下文窗口的位置编码通过插值法压缩到预训练的上下文窗口中。相比于前两种方法， 插值法可以在不改变原有的预训练模型情况下，直接扩展上下文窗口。关键思想是：直接缩小位置索引，使最大位置索引与预训练阶段的上下文窗口限制相匹配</p>
<p>




  
  
  
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/Untitled%2018.jpeg" alt="Untitled" />
      
    </figure>
  

</p>
</li>
</ul>


<h2 class="relative group">强化学习 (RL) 
    <div id="%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0-rl" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0-rl" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p><strong>强化学习</strong> (Reinforcement Learning, RL) 研究的问题是<strong>智能体</strong>(Agent)与<strong>环境</strong> (Environment)交互，目标是使智能体在复杂且不确定的环境中最大化<strong>奖励</strong> (Reward)。</p>
<ul>
<li>在强化学习过程中，智能体与环境不断交互，智能体在环境中获取某个状态后，会根据该状态输出一个动作(Action)，也被称为决策 (Decision)。</li>
<li>动作会在环境中执行，环境会根据智能体采取的动作，给出下一个状态以及当前动作所带来的奖励。</li>
<li>在尝试各种行为的过程中，智能体(Agent) 会在学习一个策略(Policy)，用于决定和指导智能体的动作；同时智能体会试图估计价值(Value)，用来预测在未来采取某一行为所能带来的奖励。</li>
</ul>
<p>总的来说，强化学习的目标就是让智能体通过与环境的交互，学习到使其获得奖励最大化的策略。其中的重点是策略函数和价值函数。</p>
<p>




  
  
  
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/Untitled%2019.jpeg" alt="Untitled" />
      
    </figure>
  

</p>
<p>假定在交互过程中，会获得很多观测\(o_i\)；针对每一个观测，Agent会采取动作\(a_i\)，也会得到一个奖励\(r_i\)；定义 \(H_t\) 是观测、动作、奖励的序列：
$$
H_t = o_1,a_1,r_1,&hellip;,o_t,a_t,r_t
$$</p>
<p>Agent在采取当前行动的时候会依赖于之前得到的历史，因此可以把环境整体状态 \(S_t\) 看做历史函数，即
$$
S_t = f(H_t)
$$</p>
<p><strong>策略函数</strong>是决定了Agent的动作。策略函数会根据历史 \(S_t\) 来确定，可以分为以下两种函数表示：</p>
<ul>
<li>随机性策略 (Stochastic Policy)：假定 \(s\) 代表输入状态， \(\pi\) 表示策略函数，即 \(\pi(a|s) =p(a_t=a|s_t=s)\)，表示Agent所有动作的概率，利用这个概率分布采样，就可以得到Agent将采取的动作。</li>
<li>确定性策略 (Deterministic Policy)：指 Agent 直接采取最有可能的动作，即 \(a^*=\underset{a}{\argmax}\pi(a|s)\)</li>
</ul>
<p><strong>价值函数</strong>是对未来奖励的预测，价值函数可以根据当前的状态和动作来判断，其中 \(\gamma\) 是折扣因子，公式如下：</p>
<ul>
<li>如果只根据当前状态\(s\) 决定，用 \(V_\pi(s)\) 来表示</li>
</ul>
<p>$$
V_\pi(s) = \mathbb{E}_\pi\lbrack\sum^\infty_{k=1} \gamma^kr_{t+k+1}|s_t=s\rbrack
$$</p>
<ul>
<li>如果根据当前状态\(s\)和动作\(a\)，用 \(Q_\pi(s,a)\) 来表示</li>
</ul>
<p>$$
Q_\pi(s,a)=\mathbb{E}_\pi\lbrack\sum^\infty_{k=0}\gamma^kr_{t+k+1}|s_t=s,a_t=a\rbrack
$$</p>
<p>根据智能体Agent所学习的组件不同，可以归类为：</p>
<ul>
<li>基于价值的智能体 (Value-based Agent)：显示地学习价值函数，隐式地学习策略，策略是从所学到的价值函数推算得到的。</li>
<li>基于策略的智能体 (Policy-based Agent)：直接学习策略，不学习价值函数，价值函数隐式地表达在策略函数中。</li>
<li>演员-评论员智能体 (Actor-critic Agent)：既学习策略又学习价值函数，通过两者的交互得到最佳的动作。</li>
</ul>
<p>最后说说强化学习的重要作用，可以概括为以下几个方面：</p>
<ol>
<li>强化学习比有监督学习更可以考虑整体影响</li>
<li>强化学习更容易解决幻觉问题</li>
<li>强化学习可以更好地解决多轮对话奖励累积的问题</li>
</ol>


<h3 class="relative group">基于人类反馈的强化学习 
    <div id="%E5%9F%BA%E4%BA%8E%E4%BA%BA%E7%B1%BB%E5%8F%8D%E9%A6%88%E7%9A%84%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E5%9F%BA%E4%BA%8E%E4%BA%BA%E7%B1%BB%E5%8F%8D%E9%A6%88%E7%9A%84%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0" aria-label="Anchor">#</a>
    </span>        
    
</h3>


<h3 class="relative group">给予人类反馈的强化学习 (RLHF) 
    <div id="%E7%BB%99%E4%BA%88%E4%BA%BA%E7%B1%BB%E5%8F%8D%E9%A6%88%E7%9A%84%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0-rlhf" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E7%BB%99%E4%BA%88%E4%BA%BA%E7%B1%BB%E5%8F%8D%E9%A6%88%E7%9A%84%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0-rlhf" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>研究者追求将人工智能与人类价值观对齐，提出了大语言模型输出的结果应该满足<em>帮助性(Helpfulness)</em>、<em>真实性(Honesty)</em>、*无害性(Harmless)*的3H原则，基于此提出了基于人类反馈的强化学习(Reinforcement Learning from Human Feedback，RLHF)。</p>
<p>RLHF 主要分为<strong>奖励模型训练</strong>和<strong>近端策略优化</strong>两个步骤。</p>
<ul>
<li>奖励模型优化通过由人类反馈标注的偏好数据来学习，判断模型回复的有用性以及保证内容的无害性。在获得奖励模型后，需要借助强化学习进行微调。</li>
<li>近端策略优化(Proximal Policy Optimization, PPO)可以根据奖励模型获得的反馈优化模型，通过不断的迭代，让模型探索和发现更符合人类偏好的回复策略。</li>
</ul>


<h4 class="relative group">奖励模型 
    <div id="%E5%A5%96%E5%8A%B1%E6%A8%A1%E5%9E%8B" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E5%A5%96%E5%8A%B1%E6%A8%A1%E5%9E%8B" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>受限于工作量和时间的限制，针对每次优化迭代，人类很难提供足够的反馈。更为有效的方法就是构建奖励模型 (Reward Model)，模拟人类的评估过程。奖励模型主要分为以下2个步骤：</p>
<ol>
<li>
<p>数据收集：以HH-RLHF数据集为例，是一种将强化学习与人类反馈结合的数据集，旨在提供复杂情境下符合人类只觉得有效表达。</p>
<p>




  
  
  
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/Untitled%2020.jpeg" alt="Untitled" />
      
    </figure>
  

</p>
</li>
<li>
<p>模型训练：奖励模型通常也采用基于 Transformer 架构的预训练语言模型，移除最后一个非嵌入层，并在最终的 Transformer 层上叠加一个额外的线性层。无论何种文本，奖励模型都能为文本序列中的最后一个标记分配一个<strong>标量奖励值</strong>，样本质量越高奖励值越大。</p>
</li>
</ol>


<h4 class="relative group">近端策略优化 
    <div id="%E8%BF%91%E7%AB%AF%E7%AD%96%E7%95%A5%E4%BC%98%E5%8C%96" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E8%BF%91%E7%AB%AF%E7%AD%96%E7%95%A5%E4%BC%98%E5%8C%96" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>近端策略优化(Proximal Policy Optimization, PPO) 是对强化学习中策略梯度方法的改进，提高了强化学习算法的可靠性和适用性。</p>
<p>近端策略优化主要涉及4个模型</p>
<ul>
<li>策略模型 (Policy Model )：用于生成模型回复</li>
<li>奖励模型 (Reward Model)：输出奖励分数来评估回复质量的好坏</li>
<li>评论模型 (Critic Model)：预测回复的好坏，可以在训练过程中实时调整模型，选择对未来累积收益最大化的行为</li>
<li>参考模型 (Reference Model)：提供一个SFT模型的备份，帮助模型不会出现过于极端的变化</li>
</ul>
<p>近端策略优化的的实施流程如下：</p>
<ol>
<li>环境采样：策略模型基于给定输入生成一系列回复，奖励模型则对这些回复进行奖励</li>
<li>优势估计：利用评论模型预测生成回复的未来累积奖励，并借助广义优势估计(Generalized Advantage Estimation, GAE) 算法来估计优势函数，能够有助于更能准确地评估每次行动的好处</li>
<li>优化调增：使用优势函数优化和调整策略模型，同时利用参考模型保证更新的策略不会有太大的改变，从而维持模型的稳定性</li>
</ol>
<p>




  
  
  
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/Untitled%2021.jpeg" alt="Untitled" />
      
    </figure>
  

</p>


<h2 class="relative group">大语言模型应用 
    <div id="%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E5%BA%94%E7%94%A8" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E5%BA%94%E7%94%A8" aria-label="Anchor">#</a>
    </span>        
    
</h2>


<h3 class="relative group">推理规划 
    <div id="%E6%8E%A8%E7%90%86%E8%A7%84%E5%88%92" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E6%8E%A8%E7%90%86%E8%A7%84%E5%88%92" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>为了增加大模型的推理能力，提出了两种方法：</p>
<ul>
<li>
<p>思维链提示 (Chain-of-Thought Prompting，CoT)：除了将问题输入给模型外，还将类似题目的解题思路和步骤输入模型，使得模型不仅输出最终结果，还输出中间步骤，从而提供模型的推理能力。</p>
<p>上交和Amazon的研究员提出了 Auto-Cot 方法，通过采样具有多样性的问题和生成推理链来构成范例，具体包括两个阶段：</p>
<ol>
<li>问题聚类：将给定数据集中的问题划分为几个簇(Cluster)</li>
<li>范例采样：从每个簇中选择一个代表性问题，并使用简单的启发式方法使用 Zero-shot Cot [仅需告知模型”<em>让我们一步一步思考 (Let’s think step by step)</em> ”] 生成推理链</li>
</ol>
<p>




  
  
  
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/Untitled%2022.jpeg" alt="Untitled" />
      
    </figure>
  

</p>
</li>
<li>
<p>由少至多提示 (Least-to-Most Prompting)：试图利用大语言模型的规划能力，将复杂问题分解为一系列子问题并以此解决它们。</p>
</li>
</ul>
<p>




  
  
  
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/Untitled%2023.jpeg" alt="Untitled" />
      
    </figure>
  

</p>


<h3 class="relative group">智能代理 
    <div id="%E6%99%BA%E8%83%BD%E4%BB%A3%E7%90%86" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E6%99%BA%E8%83%BD%E4%BB%A3%E7%90%86" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>智能代理可以被视为独立个体，接收并处理外部信息，进而给出响应。智能代理主要由以下3个模块组成：</p>
<ul>
<li>思考模块：具有<strong>自然语言理解与生成能力</strong>，<strong>推理与规划能力</strong>，<strong>反思与学习能力</strong>等。</li>
<li>记忆模块：记忆模块主要分为内置记忆和外置记忆。内置记忆主要是<strong>对世界知识的记忆</strong>，通过编码等方式将知识隐式存储在模型参数中，类似知识库；外置记忆主要是<strong>社会属性的记忆</strong>，包括对自我自我社会身份的认知、过去的社会交互经理等，需要依靠动态的外置记忆。</li>
<li>工具调用模块：工具不局限于特定环境，而是侧重与能够扩展语言模型功能的接口。</li>
</ul>
<p>智能代理具体的工作流程如下</p>
<ol>
<li>对于外界的输入，智能代理借助多模态将文字、音频、图像等多种形式的信息转换为机器能够理解的表现形式</li>
<li>由规划模块对信息进行处理，结合记忆模块完成推理、规划等复杂任务</li>
<li>最后，智能代理可能会利用工具调用模块执行相应动作，对外部输入做出相应</li>
</ol>
<p>




  
  
  
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/Untitled%2024.jpeg" alt="Untitled" />
      
    </figure>
  

</p>


<h3 class="relative group">多模态 
    <div id="%E5%A4%9A%E6%A8%A1%E6%80%81" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E5%A4%9A%E6%A8%A1%E6%80%81" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>多模态主要是为了促进大语言模型和其他模态基础模型的交互融合。多模态的任务类型主要有以下几种</p>
<table>
<thead>
<tr>
<th>任务类型</th>
<th>Task Type</th>
<th>任务描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>图文检索</td>
<td>Image-Text Retrieval</td>
<td>包括图像到文本、文本到图像的检索</td>
</tr>
<tr>
<td>图像描述</td>
<td>Image Captioning</td>
<td>根据给定图像生成描述性文本</td>
</tr>
<tr>
<td>视觉回答</td>
<td>Visual Question Answering</td>
<td>回答与给定图像相关的问题</td>
</tr>
<tr>
<td>视觉推理</td>
<td>Visual Reasoning</td>
<td>根据给定图像进行逻辑推理</td>
</tr>
<tr>
<td>图像生成</td>
<td>Image Generating</td>
<td>根据本文描述生成图像</td>
</tr>
</tbody>
</table>
<p>线面以 MiniGPT-4 介绍大语言模型的架构。具体主要有三个部分组成：</p>
<ul>
<li>预训练大语言模型：MiniGPT-4使用的大模型是Vicuna 模型，主要任务是同时理解输入进来的文本与图像数据</li>
<li>预训练的视觉编码器：这部分主要有两个部分组成：视觉编码器 ViT (Vision Transformer) 和 图文对齐模块 Q-Former 组成。具体的流程是
<ol>
<li>首先通过 ViT 做初步编码，提取出图像中的基本视觉特征</li>
<li>然后通过预训练的Q-Former 模块，将视觉编码与文本编码对齐，得到大模型可以理解的向量编码</li>
</ol>
</li>
<li>单一的线性投影层：弥补视觉编码器和大模型之间的差距，通过定义一个可循来拿的线性投影层，期望通过训练将编码的视觉特征与 Vicuna 语言模型对齐。</li>
</ul>
<p>




  
  
  
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/Untitled%2025.jpeg" alt="Untitled" />
      
    </figure>
  

</p>


<h2 class="relative group">大语言模型评估 
    <div id="%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>最后这部分是<strong>模型评估(Model Evaluation)</strong>，也称为<strong>模型评价</strong>，目标是评估模型在魏建国的数据上的泛化能力和预测准确性。目前针对单一任务的自然语言处理算法，通常需要构造独立与训练数据的评估数据集。</p>


<h3 class="relative group">评估体系 
    <div id="%E8%AF%84%E4%BC%B0%E4%BD%93%E7%B3%BB" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E8%AF%84%E4%BC%B0%E4%BD%93%E7%B3%BB" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>评估标准和体系主要分为三类：</p>
<ul>
<li>知识与能力：主要评估大模型的通用能力，如解决多种任务的能力，可以评估大模型的帮助性和真实性</li>
<li>伦理和安全：用于评估大模型的无害性</li>
<li>垂直领域评估：针对垂直领域和终点能力的细粒度评估</li>
</ul>


<h4 class="relative group">知识与能力 
    <div id="%E7%9F%A5%E8%AF%86%E4%B8%8E%E8%83%BD%E5%8A%9B" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E7%9F%A5%E8%AF%86%E4%B8%8E%E8%83%BD%E5%8A%9B" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>知识与能力的评估方法主要有两类：</p>
<ul>
<li>
<p>HELM评测：以任务为核心的评估体系。</p>
<p>HELM基于是哪个基本设计原则：① 覆盖率 ② 最小化所选场景集合 ③优先选择与用户任务相应的场景</p>
<p>构造了42类评测场景，基于<em>任务</em>、<em>领域</em>、<em>语言或语言变体</em>，并进一步将领域细分为What(内容体裁)、Who(用户/人口群体)、When(时间段)。</p>
<p>




  
  
  
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/Untitled%2026.jpeg" alt="Untitled" />
      
    </figure>
  

</p>
</li>
<li>
<p>AGIEval 评估：以人为核心的评估体系，选择与人类认知和问题解决密切相关的任务。</p>
<p>AGIEval基于两个基本设计原则：① 强调人类水平的认知任务 ② 与现实世界场景相关</p>
<p>基于此，AGIEval 融合了各种官方、公开和高标准的入学和资格考试，包括高等教育入学考试、法院数学考试、数学考试、律师资格考试和国家公务员考试等等</p>
</li>
</ul>


<h4 class="relative group">伦理与安全 
    <div id="%E4%BC%A6%E7%90%86%E4%B8%8E%E5%AE%89%E5%85%A8" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E4%BC%A6%E7%90%86%E4%B8%8E%E5%AE%89%E5%85%A8" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>伦理与安全主要有：</p>
<ul>
<li>
<p>安全伦理评测集合：包含<strong>8种常见的伦理与安全评估场景</strong>(<em>侮辱性内容、不公平和歧视性问题、犯罪和非法活动、敏感话题、身体伤害、心理健康、隐私和财产、伦理和道德</em>)和<strong>6种指令攻击方法</strong> (<em>目标劫持、提示泄露、角色扮演、不安全的指令主题、注入不易察觉的不安全内容、逆向暴露</em>)。</p>
</li>
<li>
<p>针对偏见的评测集合，如CrowSPairs：涵盖<strong>9种类型偏见</strong> (<em>种族、性别、性取向、宗教、年龄、国际、残疾、外貌、社会经济地位</em>)</p>
</li>
<li>
<p>安全伦理“红队”测试：训练可以产生大量安全伦理相关测试样本的大语言模型 (简称”红队”)，通过“红队” (Red Teaming)大语言模型产生的测试样例，让目标大语言模型进行回答，最后利用分类器进行有害性判断。</p>
<p>




  
  
  
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/Untitled%2027.jpeg" alt="Untitled" />
      
    </figure>
  

</p>
</li>
</ul>


<h4 class="relative group">垂直领域领域 
    <div id="%E5%9E%82%E7%9B%B4%E9%A2%86%E5%9F%9F%E9%A2%86%E5%9F%9F" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E5%9E%82%E7%9B%B4%E9%A2%86%E5%9F%9F%E9%A2%86%E5%9F%9F" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>垂直领域领域的评估主要包括三个方面：</p>
<ul>
<li>复杂推理：理解和利用支持性证据或逻辑得出结论或做出决策，这方面的评估可以分成三个维度：知识推理、符号推理和数学推理</li>
<li>环境交互：指评估从外部环境接受反馈并根据行为指令执行操作的能力，如生成自然语言描述的在某个现实场中下详细而高度逼真的行动计划</li>
<li>特定领域：主要指一些针对特定领域开展的工作，如医疗、法律、财经等等</li>
</ul>


<h3 class="relative group">评估指标和方法 
    <div id="%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87%E5%92%8C%E6%96%B9%E6%B3%95" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87%E5%92%8C%E6%96%B9%E6%B3%95" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>分别针对分类任务、回归任务、语言模型、文本生成有不同的大模型评估指标，下面我们逐一介绍</p>


<h4 class="relative group"><strong>分类任务评估指标</strong> 
    <div id="%E5%88%86%E7%B1%BB%E4%BB%BB%E5%8A%A1%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E5%88%86%E7%B1%BB%E4%BB%BB%E5%8A%A1%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p><strong>分类任务</strong>是指将输入样本分为不同类别或标签的机器学习任务，包括分词、词性标注、情感分析等。分类任务的评估指标有 ：</p>
<p>




  
  
  
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/Untitled%2028.jpeg" alt="Untitled" />
      
    </figure>
  

</p>
<ul>
<li>准确率(Accuracy)：表示分类正确的样本占全部样本的比例</li>
</ul>
<p>$$
Accuracy = \frac{TP + TN}{TP+FN+FP+TN}
$$</p>
<ul>
<li>精准度(Precision，P)：表示分类预测是正例的结果中，回答正确的比率</li>
</ul>
<p>$$
Precision = \frac{TP}{TP+FP}
$$</p>
<ul>
<li>召回率 (Recall, R)：表示所有正例样本中，被正确找出的比率。</li>
</ul>
<p>$$
Recall = \frac{TP}{TP+FN}
$$</p>
<ul>
<li>F1值 (F1-Score)：精确度和召回率的调和均值</li>
</ul>
<p>$$
F1=\frac{2\times P\times R}{P + R}
$$</p>
<ul>
<li>PR曲线 (PR Curve)：横坐标为召回率R，纵坐标为精度P。平衡点 (Break-Even Point， BEP) 是精确度等于召回率的取值，越大则表示效果越优</li>
</ul>


<h4 class="relative group">回归任务<strong>评估指标</strong> 
    <div id="%E5%9B%9E%E5%BD%92%E4%BB%BB%E5%8A%A1%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E5%9B%9E%E5%BD%92%E4%BB%BB%E5%8A%A1%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p><strong>回归任务</strong> (Regression) 是根据输入样本预测一个连续的数值的机器学习任务。例如情感强度判断、作为评分、垃圾邮件识别等。</p>
<p>回归任务的评估指标有：</p>
<ul>
<li>平均绝对误差 (Mean Absolute Error, MAE)：表示真实值与预测值之间绝对误差损失的预期值</li>
</ul>
<p>$$
MAE(y,\hat{y})=\frac{1}{n}\sum^n_{i=1}|y_i-\hat{y_i}|
$$</p>
<ul>
<li>平均绝对百分比误差(Mean Absolute Percentage Error，MAPE)：表示真实值与预测值之间相对误差的预期值</li>
</ul>
<p>$$
MAPE(y,\hat{y})=\frac{1}{n}\sum^n_{i=1}\frac{|y_i-\hat{y_i}|}{|y_i|}
$$</p>
<ul>
<li>均方误差 (Mean Squared Error，MSE)：表示真实值与预测值之间平方误差的期望</li>
</ul>
<p>$$
MSE(y, \hat{y})=\frac{1}{n}\sum^n_{i=1}||y_i-\hat{y_i}||^2_2
$$</p>
<ul>
<li>均方误差根 (Root Mean Squared Error，RMSE)：表示真实值与预测值之间平方误差期望的平方根</li>
</ul>
<p>$$
RMSE(y, \hat{y})=\sqrt{\frac{1}{n}\sum^n_{i=1}||y_i-\hat{y_i}||^2_2}
$$</p>
<ul>
<li>均方误差对数( Mean Squared Log Error，MSLE)：表示对应真实值与预测值之间平方对数差的预期</li>
</ul>
<p>$$
MSLE(y,\hat{y})=\frac{1}{n}\sum^n_{i=1}(log(1+y_i)-log(1+\hat{y_i}))^2
$$</p>
<ul>
<li>中位绝对误差 (Median Absolute Error，MedAE)：表示真实值与预测值之间绝对差值的中值</li>
</ul>
<p>$$
MedAE(y,\hat{y})=median(|y_1-\hat{y_1}|,&hellip;,|y_i-\hat{y_i}|)
$$</p>


<h4 class="relative group">语言模型<strong>评估指标</strong> 
    <div id="%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>语言模型最直接的测评方法就是使用模型计算测试集的概率，或者利用交叉熵和困惑度等派生测度。对于一个平滑过的 \(P(w_i|w^{i-1}_{i-n+1})\) n元语言模型，可以用下列公式计算句子 \(P(s)\)的概率：</p>
<p>$$
P(s) = \prod^n_{i=1}P(w_i|w^{i-1}_{i-n+1})
$$</p>
<p>对于由句子\((s_1,s_2,&hellip;,s_n)\) 组成的测试集\(T\)，基于 \(P(s)\) 我们可以计算一下三个指标：</p>
<ul>
<li>测试集概率：</li>
</ul>
<p>$$
P(T) = \prod^n_{i=1}P(s_i)
$$</p>
<ul>
<li>交叉熵：利用预测和压缩的关系进行计算，其中\(W_s\) 为文本\(s\)的长度，以下公式可以解释为：利用压缩算法对\(s\) 中的\(W_s\)个词进行编码，每一个编码所需要的平均比特位数</li>
</ul>
<p>$$
H_p(s)=-\frac{1}{W}log_2P(s)
$$</p>
<ul>
<li>困惑度：为模型分配给测试集中每一个词汇的概率的集合平均值的倒数，他和交叉熵的关系为：</li>
</ul>
<p>$$
PP_s(s)=2^{H_p(s)}
$$</p>
<p>交叉熵和困惑度越小，模型性能就越好。</p>


<h4 class="relative group">文本生成<strong>评估指标</strong> 
    <div id="%E6%96%87%E6%9C%AC%E7%94%9F%E6%88%90%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E6%96%87%E6%9C%AC%E7%94%9F%E6%88%90%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>文本生成任务包括机器翻译、摘要生成等。</p>
<p>在机器翻译任务中，通常使用 <strong>BLEU</strong> (Bilingual Evaluation Understudy) 用于评估生成的翻译句子和参考翻译句子之间的差异指标。BLEU的核心思想是衡量机器翻译所产生的译文和参考翻译之间的匹配度，原理是统计机器所产生的译文中的词汇有多少个出现在参考译文中，从某种意义上是一种精准度的衡量。</p>
<p>摘要生成任务中主要采取 <strong>ROUGE</strong> (Recall-Oriented Understudy for Gisting Evaluation) 评估方法，也称为<strong>面向召回率的要点评估</strong>。</p>


<h4 class="relative group">评估方法 
    <div id="%E8%AF%84%E4%BC%B0%E6%96%B9%E6%B3%95" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E8%AF%84%E4%BC%B0%E6%96%B9%E6%B3%95" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>有了评估体系和评估指标后，评估方法的目标是解决如何对大语言模型生成结果进行评估，具体的方法有：</p>
<ul>
<li>自动评估 (Automatic Evaluation)：部分指标可以通过比较正确答案或参考答案与系统生成结果来直接计算得出</li>
<li>人工评估 (Human Evaluation)：人工阅读并进行分项打分</li>
<li>大语言模型评估 （LLM Evaluation）：利用能力较强的语言模型，构建合适的指令来评估系统结果</li>
<li>对比评估 (Comparative Evaluation)：对比不同系统之间或系统不同版本的差别，针对系统之间的不同进行量化</li>
</ul>

        </div>
        
        

        
        

          
      </div>
     
      
      
        
        
          
          
        
      <script>
        var oid = "views_articels\/2023-12-10\/index.md"
        var oid_likes = "likes_articels\/2023-12-10\/index.md"
      </script>
      
      
      
      <script type="text/javascript" src="/js/page.min.b06a29d42a4ed16787978e2eee1e8c797b7698db2bc14ccee78f5c80ac566fc996190a73ad80a5e987558474b20b96fa38f7d85b405f165ff72b7b163c5ad11b.js" integrity="sha512-sGop1CpO0WeHl44u7h6MeXt2mNsrwUzO549cgKxWb8mWGQpzrYCl6YdVhHSyC5b6OPfYW0BfFl/3K3sWPFrRGw=="></script>
  
    </section>
  <footer class="pt-8 max-w-prose print:hidden">

    
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group mr-3" href="/articels/2023-12-01/">
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >TiDB知识点梳理 (PCTA 笔记)</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2023-12-01 00:00:00 &#43;0000 UTC">1 December 2023</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="flex text-right group ml-3" href="/articels/2024-01-01/">
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >2023年总结</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2024-01-01 00:00:00 &#43;0000 UTC">1 January 2024</time>
                  
                </span>
              </span>
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


    
  </footer>
</article>

      <div id="top-scroller" class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0">
  <a href="#the-top"
    class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top" title="Scroll to top">
    &uarr;
  </a>
</div>
    </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
    <nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400">
      <ul class="flex flex-col list-none sm:flex-row">
        
        <li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
          <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=""
            title="">
            
            
          </a>
        </li>
        
      </ul>
    </nav>
    
  
  <div class="flex items-center justify-between">

    
    
    <p class="text-sm text-neutral-500 dark:text-neutral-400">
      &copy;
      2024
      Utkarsh Deoli
    </p>
    

    
    

  </div>
  <script>
    
    mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
      margin: 24,
      background: 'rgba(0,0,0,0.5)',
      scrollOffset: 0,
    })
    
  </script>
  
  
  <script type="text/javascript" src="/js/process.min.62060bb247f4de2b6dde45903668fefb68d792f365587605177b1227c0cf43588701edaca0cb40e2c8e2789bd5ce67c1d2a215b9fb258c3496a7cd25e7cb5fdf.js" integrity="sha512-YgYLskf03itt3kWQNmj&#43;&#43;2jXkvNlWHYFF3sSJ8DPQ1iHAe2soMtA4sjieJvVzmfB0qIVufsljDSWp80l58tf3w=="></script>
  
  
</footer>
  </div>
</body>

</html>
